<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ROC DUBAI</title>
  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="white">
  <meta name="apple-mobile-web-app-title" content="ROC DUBAI">
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" href="/icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="/icons/icon-192.png" />
  <link rel="stylesheet" href="/styles.css" />
  <script>
    window.AZURA_EMBED_URL = "https://a10.asurahosting.com/public/radio-dubai/embed?theme=light";
  </script>
</head>
<body>
  <main class="wrap">
    <header class="brand">
      <div class="logo">RD</div>
      <div class="titles">
        <h1>ROC DUBAI</h1>
        <p>Live • Best Hits 24/7</p>
      </div>
      <a href="http://www.internet-radio.com/station/radiodubaipersian/" target="_blank" rel="noopener">
        Listen also on Internet-Radio.com
      </a>
    </header>

    <section class="card">
      <div class="frame-wrap">
        <iframe id="player" title="Radio Player" loading="lazy" allow="autoplay; encrypted-media" referrerpolicy="no-referrer"></iframe>
      </div>
    </section>

    <div class="install-row" id="installRow" hidden>
      <button id="btnInstall" class="install-btn">نصب اپ</button>
    </div>

    <div class="install-row ios-instructions" id="iosInstructions" hidden>
      <p>برای نصب: <strong>اشتراک‌گذاری</strong> ➜ <strong>افزودن به صفحه اصلی</strong></p>
    </div>

    <footer class="foot">© ORVIO 2025</footer>
  </main>

  <script defer src="https://app.fastbots.ai/embed.js" data-bot-id="cmfgdz0zp02bhpe1m9m6m5qpv"></script>

  <script>
    document.getElementById('player').src = window.AZURA_EMBED_URL;

    let deferredPrompt;
    const installRow = document.getElementById('installRow');
    const iosInstructions = document.getElementById('iosInstructions');
    const btnInstall = document.getElementById('btnInstall');

    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);

    if (isIOS && isSafari) {
      setTimeout(() => iosInstructions.hidden = false, 3000);
    } else {
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installRow.hidden = false;
      });

      btnInstall?.addEventListener('click', async () => {
        if (!deferredPrompt) return;
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') installRow.hidden = true;
        deferredPrompt = null;
      });
    }

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(err => console.log('SW error:', err));
      });
    }
  </script>

  <style>
    .install-row { text-align: center; margin: 16px; }
    .install-btn { background:#007aff; color:white; border:none; padding:12px 24px; border-radius:8px; font-size:16px; cursor:pointer; }
    .ios-instructions { background:#f0f0f0; padding:12px; border-radius:8px; font-size:14px; color:#333; }
  </style>
</body>
</html>
